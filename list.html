<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Gas Company!</title>
</head>

<style>
    body,
    html {
        height: 100%;
        margin: 0;
    }

    .star {
        font-size: x-large;
    }

    .bg {
        /* The image used */
        /* background-image: url("img/natural.jpg"); */
        background-color: aliceblue;
        /* display: grid; */
        /* Full height */
        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
    }

    #myrow {
        cursor: pointer;
    }

    .carousel-control-next-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='blue' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E");
    }

    .carousel-control-prev-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='blue' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E");
    }
</style>
<link rel="stylesheet" href="./css/Messages.css">

<body onload="list()" class="bg">
    <nav class="navbar navbar-light bg-light" style="height: max-content;">
        <a class="navbar-brand" style="display: inline-flex;">
            <img src="/img/gas-natural.svg" width="60" height="60" class="d-inline-block" alt="">
            <h2 class="pt-2" style="margin-left: 10%;">Caribean Gas</h2>
        </a>
    </nav>

    <!-- <div class="card" id="cardall"> -->
    <!-- <div class="card-header">
            Aptitudes Test
        </div> -->
    <!-- <div class="card-body overflow-auto"> -->
    <div class="container">

        <div class="callout" id="cardmsg">
            <div class="callout-header">Messages</div>
            <span class="closebtn" onclick="this.parentElement.style.display='none';">Ã—</span>
            <div class="callout-container" id="msg">

            </div>
        </div>
        <div class="row pt-3 pb-4">
            <div class="col">
                <h1 id="number">Employees</h1>
            </div>
            <div class="col text-right ">

            </div>
        </div>
        <div class="container-fluid">
            <div class="input-group mb-4">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">User</button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="#">Score</a>
                        <a class="dropdown-item" href="#">Another action</a>
                    </div>
                </div>
                <input type="text" class="form-control" placeholder="Search..."
                    aria-label="Text input with dropdown button">
                <!-- <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button" id="button-addon2">GO!</button>
                            </div> -->
            </div>
            <div id="list" class="container-fluid">

            </div>
            <div class="row pt-1 pb-4">
                <div class="col text-right ">
                    <a href="preguntas.html" class="btn btn-primary" role="button">New Test</a>
                    <a href="signupem.html" class="btn btn-primary" role="button">New Employee</a>
                    <a class="btn btn-primary text-white" onclick="myFunction()" role="button">&nbsp Logout &nbsp</a>
                </div>
            </div>
        </div>
    </div>
    <!-- </div> -->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <!--sweetAlert2-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <!-- Firebase js -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-functions.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyBQnFZIdOu1iHflA3TSQX5-uqAoEunf66E",
            authDomain: "parcial-2-de682.firebaseapp.com",
            databaseURL: "https://parcial-2-de682.firebaseio.com",
            projectId: "parcial-2-de682",
            storageBucket: "parcial-2-de682.appspot.com",
            messagingSenderId: "605657635467",
            appId: "1:605657635467:web:c2269af816af101420d28e",
            measurementId: "G-DE561MK6M7"
        };
        // Initialize Firebase

        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
    <script src="js/employee.js"></script>
    <script src="js/questions.js"></script>
    <script>

        async function message() {
            var employess = await gestTest(localStorage.uid);
            console.log(employess)
            var myvar = "";
            var ele = document.getElementById("msg");
            employess.forEach(employe => {
                var name = employe.name
                myvar += '<p>' + employe.name + '<br> Hizo el test el ' + new Date(employe.questionary.date).toLocaleString() + '</p> <hr style="border-block-color: black">';
            });
            ele.innerHTML = myvar;
            document.getElementById("cardmsg").style = '';
        }

        onTest();

        async function list() {
            var employess = await getEmployees();
            var ele = document.getElementById("list");
            let i = 0;
            var myvar;
            employess.forEach((employe) => {
                console.log(employe.key)
                i++;
                var uid = "?uid=" + employe.key;
                var aux = "" + employe.key;
                myvar = '<div class="row align-items-center border border-secondary shadow-sm p-3 mb-4 bg-white rounded" id=myrow'+i+' >' +
                    '                    <div class="col-md-1">' +
                    '                        <a id="basic-addon1">' +
                    '                            <img src="/img/usuarioblue.svg" width="40" height="40" class="d-inline-block" alt="">' +
                    '                        </a>' +
                    '                    </div>' +
                    '                    <div class="col-md-7">' +
                    '                        <h3>' + employe.val().name + '</h3>' +
                    '                    </div>' +
                    '                    <div class="col text-right ">' +
                    '                        <a class="btn btn-primary text-white" id="'+aux+'" onclick="disableEmp(this.id)">Disable</a>' +
                    '                    </div>' +
                    '                    <div class="col text-right ">' +
                    '                        <a class="btn btn-primary text-white" id="'+aux+'" onclick="enableEmp(this.id)">Enable</a>' +
                    '                    </div>' +
                    '                    <div class="col text-right ">' +
                    '                        <a class="btn btn-primary" href="signupem.html' + uid + '">Edit</a>' +
                    '                    </div>' +
                    '                    <div class="col text-right ">' +
                    '                        <a class="btn btn-primary text-white" id="'+aux+'" onclick="deleteEmpl(this.id)">Deleted</a>' +
                    '                    </div>' +
                    '                    <div class="col text-right ">' +
                    '                        <a class="btn btn-primary" href="test_r.html' + uid + '">Check Results</a>' +
                    '                    </div>' +
                    '                </div>';
                ele.innerHTML += "\n" + myvar;
            });
            document.getElementById("number").innerHTML = "Employees (" + i + ")";
            message();
        };


        
        async function myFunction() {
            await firebase.auth().signOut();
            window.location = "index.html";
        };
    </script>
    <!-- Firebase js -->
</body>

</html>