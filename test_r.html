<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Gas Company!</title>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<style>
    body,
    html {
        height: 100%;
        margin: 0;
    }

    .star {
        font-size: xx-large;
    }

    .bg {
        /* The image used */
        background-image: url("img/natural.jpg");
        /* display: grid; */
        /* Full height */
        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;

    }

    #cardall {
        margin: auto;
        width: 90%;
        height: 80%;
        border-radius: 15px;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    }

    .carousel-control-next-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='blue' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E");
    }

    .carousel-control-prev-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='blue' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E");
    }
</style>

<body onload="myFunction()" class="bg">

    <nav class="navbar navbar-light bg-light mb-4" style="height: max-content;">
        <a class="navbar-brand" style="display: inline-flex;">
            <img src="/img/gas-natural.svg" width="60" height="60" class="d-inline-block" alt="">
            <h2 class="pt-2" style="margin-left: 10%;">Caribean Gas</h2>
        </a>
    </nav>

    <div class="card" id="cardall">
        <div class="card-header">
            Aptitudes Test
        </div>
        <div class="card-body overflow-auto">
            <div class="row  pt-3 pb-4">
                <div class="col">
                    <h1>Test Results</h1>
                </div>

            </div>
            <div class="container">
                <div id="card">
                    <!-- <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Loading...</span>
                              </div> -->
                    <div id="chart">
                    </div>
                </div>
                <div class="row pt-1 pb-4">
                    <div id="grade" class="col text-right ">
                        
                    </div>
                    <div class="col-md-5 text-right ">
                        <a class="btn btn-primary" onclick="deltest()" id="deltest" style="display:none" role="button">Delete Test</a>
                        <a class="btn btn-primary" onclick="logout()" id="endtest" style="display:none" role="button">End Test</a>
                        <a class="btn btn-primary" onclick="window.location = 'list.html'" style="display:none" id="back" role="button">Back</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
</body>
<!--sweetAlert2-->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<!-- Firebase js -->
<script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-database.js"></script>
<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyBQnFZIdOu1iHflA3TSQX5-uqAoEunf66E",
        authDomain: "parcial-2-de682.firebaseapp.com",
        databaseURL: "https://parcial-2-de682.firebaseio.com",
        projectId: "parcial-2-de682",
        storageBucket: "parcial-2-de682.appspot.com",
        messagingSenderId: "605657635467",
        appId: "1:605657635467:web:c2269af816af101420d28e",
        measurementId: "G-DE561MK6M7",
    };
    // Initialize Firebase

    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
</script>
<script src="js/questions.js"></script>
<script src="js/rediret.js"></script>
<script>
    validate()
    async function validate() {
    if(await isEmployee()){
        document.getElementById("endtest").style="";
    }else{
        document.getElementById("deltest").style="";
        document.getElementById("back").style="";
    }
}
    async function myFunction() {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        var answe = await getResults(urlParams.get('uid'));
        total = (answe.grade / answe.total) * 100;
        document.getElementById("grade").innerHTML="<h1 class='text-muted'>"+answe.grade+"/"+answe.total+"</h1>";
        divuyito(total);
    }
    async function deltest() {
        await deleteResults();
        Swal.fire({
            icon: "success",
            title: "Test Deleted",
          }).then(()=>{
            window.location = "list.html";
          });
        
    };

    async function logout() {
        await firebase.auth().signOut();
        window.location = "index.html";
    };

    function divuyito(total) {
        var options = {
            series: [total],
            chart: {
                height: 350,
                type: 'radialBar',
                toolbar: {
                    show: false
                }
            },
            plotOptions: {
                radialBar: {
                    startAngle: -135,
                    endAngle: 225,
                    hollow: {
                        margin: 0,
                        size: '70%',
                        background: '#fff',
                        image: undefined,
                        imageOffsetX: 0,
                        imageOffsetY: 0,
                        position: 'front',
                        dropShadow: {
                            enabled: true,
                            top: 3,
                            left: 0,
                            blur: 4,
                            opacity: 0.24
                        }
                    },
                    track: {
                        background: '#fff',
                        strokeWidth: '67%',
                        margin: 0, // margin is in pixels
                        dropShadow: {
                            enabled: true,
                            top: -3,
                            left: 0,
                            blur: 4,
                            opacity: 0.35
                        }
                    },

                    dataLabels: {
                        show: true,
                        name: {
                            offsetY: -10,
                            show: true,
                            color: '#888',
                            fontSize: '17px'
                        },
                        value: {
                            formatter: function (val) {
                                return parseInt(val);
                            },
                            color: '#111',
                            fontSize: '36px',
                            show: true,
                        }
                    }
                }
            },
            fill: {
                type: 'gradient',
                gradient: {
                    shade: 'dark',
                    type: 'horizontal',
                    shadeIntensity: 0.5,
                    gradientToColors: ['#ABE5A1'],
                    inverseColors: true,
                    opacityFrom: 1,
                    opacityTo: 1,
                    stops: [0, 100]
                }
            },
            stroke: {
                lineCap: 'round'
            },
            labels: ['Succes Rate'],
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
    };


</script>

</html>